<script lang="ts">
	import EntryTime from '$components/EntryTime.svelte';
	import Entries from '$lib/Entries';

	export let entry: TimeEntry | undefined;
	export let onStart: () => void;
	export let onStop: () => void;
	export let onTitleChange: (text: string) => void;

	$: title = entry?.title ?? '';

	$: entryIsOpen = entry && Entries.entryOpen(entry);

	const onClick = () => {
		entryIsOpen ? onStop() : onStart();
	};
</script>

<div class="timer">
	<div class="display">
		<div class="time">
			<EntryTime {entry} />
		</div>

		<button
			on:click={onClick}
			class="button"
			aria-label={entryIsOpen ? 'Stop timer' : 'Start timer'}>{entryIsOpen ? '■' : '▶'}</button
		>
	</div>

	<input
		type="text"
		placeholder="Entry description"
		bind:value={title}
		on:input={() => onTitleChange(title)}
	/>
</div>

<style lang="scss">
	@use '../styles/colors';

	.timer {
		display: flex;
		flex-direction: column;
		flex-wrap: nowrap;
		justify-content: space-between;
		align-items: baseline;
		padding: 3rem 2rem;
	}

	.display {
		display: flex;
		width: 100%;
		align-items: center;
		justify-content: center;
		gap: 3rem;
		padding-bottom: 1.3rem;
	}

	input {
		font-size: 1rem;
		display: block;
		border: 0px;
		border-bottom: solid 0.2rem colors.$surface-600;
		margin: 0;
		width: 100%;
		padding: 1rem;
		background: rgba(0, 0, 0, 0);
		color: inherit;
	}

	.time {
		font-size: 3rem;
	}

	.button {
		display: flex;
		flex: 0 0 auto;
		align-items: center;
		justify-content: center;
		box-sizing: border-box;
		margin: 0;
		padding: 0;
		border-radius: 50%;
		border: none;
		background-color: colors.$primary-100;
		height: 3.2rem;
		width: 3.2rem;
		cursor: pointer;
		box-shadow: 0 0 0 3px rgba(colors.$primary-100, 0.5);
	}
</style>
